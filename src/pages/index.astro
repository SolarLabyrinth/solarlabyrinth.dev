---
import "../styles/global.css";

import { getCollection } from "astro:content";
import { Image } from "astro:assets";

import BaseLayout from "../layouts/BaseLayout.astro";
import ProfilesList from "../components/ProfilesList.astro";
import GamesList from "../components/GamesList.astro";

const allPosts = await getCollection("articles");
const posts = allPosts.filter(
  (post) => post.data.pubDate && post.data.heroImage && post.data.title
);
---

<BaseLayout class="max-w-[640px]">
  <ProfilesList />
  <GamesList />
  {
    posts.length > 0 && (
      <>
        <h2 class="text-3xl px-4 mt-4 mb-1 font-bold">Articles</h2>
        <ul class="flex flex-wrap px-2 @container">
          {posts.map((post) => (
            <li class="w-full p-2">
              <a href={`/articles/${post.id}`}>
                <Image
                  class="rounded-xl"
                  width={900}
                  height={450}
                  src={post.data.heroImage!}
                  alt={post.data.title}
                />
              </a>
            </li>
          ))}
        </ul>
      </>
    )
  }
</BaseLayout>
